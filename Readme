# ğŸ§  RBC - Sistema de RecomendaÃ§Ã£o Baseada em Casos

Este projeto Ã© uma API para recomendaÃ§Ã£o de locais, acomodaÃ§Ãµes e procedimentos mÃ©dicos, baseada em dados histÃ³ricos, construÃ­da com **FastAPI** e **Machine Learning**.

---

## ğŸ“š SumÃ¡rio

- [PrÃ©-requisitos](#prÃ©-requisitos)
- [ConfiguraÃ§Ã£o do Ambiente](#configuraÃ§Ã£o-do-ambiente)
- [Rodando o Projeto](#rodando-o-projeto)
  - [Com Docker (Recomendado)](#com-docker-recomendado)
  - [Sem Docker (Ambiente Local)](#sem-docker-ambiente-local)
- [ConfiguraÃ§Ã£o do Banco de Dados](#configuraÃ§Ã£o-do-banco-de-dados)
- [Utilizando a API](#utilizando-a-api)
  - [Endpoints](#endpoints)
  - [Exemplo de Uso](#exemplo-de-uso)
- [Estrutura do Projeto](#estrutura-do-projeto)
- [ObservaÃ§Ãµes e Dicas](#observaÃ§Ãµes-e-dicas)

---

## âœ… PrÃ©-requisitos

- Python 3.10+
- PostgreSQL com os dados necessÃ¡rios
- [Docker](https://www.docker.com/products/docker-desktop) (opcional, recomendado)

---

## âš™ï¸ ConfiguraÃ§Ã£o do Ambiente

Crie um arquivo `.env` na raiz do projeto com as seguintes informaÃ§Ãµes:

```env
DB_HOST=seu_host
DB_PORT=sua_porta
DB_NAME=nome_do_banco
DB_USER=usuario
DB_PASSWORD=senha
DB_TEST_NAME=nome_do_banco_teste
```

---

## ğŸš€ Rodando o Projeto

### ğŸ³ Com Docker (Recomendado)

1. **Build da imagem:**

```sh
docker build -t rbc-app ./app
```

2. **Execute o container:**

```sh
docker run --env-file .env -p 8000:8000 rbc-app
```

3. **Acesse a API:**

- http://localhost:8000/docs (Swagger UI)
- http://localhost:8000/health

---

### ğŸ’» Sem Docker (Ambiente Local)

1. **Crie e ative um ambiente virtual:**

```sh
python -m venv venv
source venv/bin/activate  # Linux/Mac
venv\Scripts\activate     # Windows
```

2. **Instale as dependÃªncias:**

```sh
pip install -r requirements.txt
```

3. **Execute a aplicaÃ§Ã£o:**

```sh
uvicorn app.main:app --reload
```

---

## ğŸ›¢ï¸ ConfiguraÃ§Ã£o do Banco de Dados

- Certifique-se de que o PostgreSQL estÃ¡ acessÃ­vel e populado com as tabelas e dados necessÃ¡rios.
- Os parÃ¢metros de conexÃ£o estÃ£o definidos no arquivo `.env`.

---

## ğŸ“¡ Utilizando a API

### Endpoints

#### ğŸ” GET `/health`
Verifica se a API estÃ¡ online.

---

#### ğŸ“ POST `/recommend/local`  
**RecomendaÃ§Ã£o de locais**

**Body:**

```json
{
  "tipogui": "string",
  "codcon": "string",
  "codmed": "string"
}
```

**Resposta:**

```json
[
  { "code": "001", "description": "Hospital A" },
  { "code": "002", "description": "Hospital B" }
]
```

---

#### ğŸ¨ POST `/recommend/acomodacao`  
**RecomendaÃ§Ã£o de acomodaÃ§Ãµes**

**Body:**

```json
{
  "tipogui": "string",
  "codcon": "string",
  "codloc": "string",
  "codmed": "string"
}
```

**Resposta:**

```json
[
  { "code": "01", "description": "Apartamento" },
  { "code": "02", "description": "Enfermaria" }
]
```

---

#### ğŸ©º POST `/recommend/procedimentos`  
**RecomendaÃ§Ã£o de procedimentos (geral e Ãºltimos 6 meses)**

**Body:**

```json
{
  "tipogui": "string",
  "codcon": "string",
  "codloc": "string",
  "acomoda": "string",
  "codmed": "string"
}
```

**Resposta:**

```json
{
  "recomendacoes_geral": [
    { "code": "40202038", "description": "" },
    { "code": "40201082", "description": "" }
  ],
  "recomendacoes_6_meses": [
    { "code": "31602231", "description": "" },
    { "code": "40202550", "description": "" }
  ]
}
```

---

## ğŸ—‚ï¸ Estrutura do Projeto

```
RBC/
â”‚
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ api/           # Rotas da API
â”‚   â”œâ”€â”€ core/          # LÃ³gica de recomendaÃ§Ã£o e ML
â”‚   â”œâ”€â”€ database/      # ConexÃ£o e queries SQL
â”‚   â”œâ”€â”€ schemas/       # Schemas Pydantic
â”‚   â”œâ”€â”€ utils/         # Handlers e utilitÃ¡rios
â”‚   â”œâ”€â”€ main.py        # InicializaÃ§Ã£o FastAPI
â”‚   â””â”€â”€ Dockerfile     # Dockerfile do projeto
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ .env
â””â”€â”€ .gitignore
```

---

## ğŸ’¡ ObservaÃ§Ãµes e Dicas

- Certifique-se de que a base de dados possui os dados esperados para obter recomendaÃ§Ãµes relevantes.
- Use o Swagger UI para testar os endpoints de forma prÃ¡tica e interativa.
- Para testes automatizados, considere configurar um banco de dados separado (usando `DB_TEST_NAME`).
